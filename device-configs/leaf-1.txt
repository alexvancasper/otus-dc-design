set groups To-Spines interfaces <xe-*> mtu 9216
set apply-groups To-Spines
set system host-name leaf-1
set system root-authentication encrypted-password "$6$To4wKwVn$0Azi91qxGPWPosdCgpxRLHpcWviVQd7jdToi5soxPYm1KUa34wJmlpXHc1XrGHrBe8.AJwkOUyf2V5rMZX1qq."
set interfaces xe-0/0/0 unit 0 family inet address 10.0.1.1/30
set interfaces xe-0/0/1 unit 0 family inet address 10.0.1.5/30
set interfaces lo0 unit 0 family inet address 10.255.254.1/32 preferred
set interfaces lo0 unit 0 family inet6 address fc00:254::1/128 preferred
set routing-options router-id 10.255.254.1
delete interfaces xe-0/0/0 unit 0 family inet dhcp
delete interfaces xe-0/0/1 unit 0 family inet dhcp

delete protocol
set protocols bgp group UNDERLAY type external
set protocols bgp group UNDERLAY local-as 65511
set protocols bgp group UNDERLAY neighbor 10.0.1.2 peer-as 65501
set protocols bgp group UNDERLAY neighbor 10.0.1.6 peer-as 65502
set protocols bgp group UNDERLAY hold-time 10
set protocols bgp group UNDERLAY family inet unicast
set protocols bgp group UNDERLAY multipath multiple-as

set policy-options policy-statement BGP_LOOPBACK0 term TERM1 from protocol direct
set policy-options policy-statement BGP_LOOPBACK0 term TERM1 from route-filter 0.0.0.0/0 prefix-length-range /32-/32
set policy-options policy-statement BGP_LOOPBACK0 term TERM1 then accept
set protocols bgp group UNDERLAY export BGP_LOOPBACK0

set policy-options policy-statement PFE-ECMP then load-balance per-packet
set routing-options forwarding-table export PFE-ECMP

